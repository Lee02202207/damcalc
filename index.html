<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>게임 대미지 계산기 + 옵션 비교기</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      max-width: 1400px;
      margin: 30px auto;
      padding: 0 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      overflow-x: hidden;
    }
    .container {
      background: white;
      border-radius: 15px;
      padding: 25px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      overflow: hidden;
    }
    h1, h2, h3 {
      color: #333;
      text-align: center;
      margin-top: 0;
    }
    h1 {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      font-size: 26px;
      margin-bottom: 15px;
    }
    
    .alert-section {
      background: #fff9e6;
      border-left: 4px solid #ff9800;
      padding: 15px;
      margin: 15px 0 25px 0;
      border-radius: 8px;
      font-size: 14px;
      line-height: 1.5;
    }
    .alert-section strong {
      color: #e65100;
    }
    .alert-section ul {
      margin: 8px 0;
      padding-left: 20px;
    }
    .alert-section li {
      margin-bottom: 5px;
    }
    
    /* 새로운 가로 배치 구조 */
    .stat-row {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 15px;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 10px;
      border-left: 5px solid #667eea;
    }
    .stat-label {
      min-width: 70px;
      font-weight: 600;
      color: #444;
      font-size: 16px;
      text-align: center;
    }
    
    .sections-container {
      display: flex;
      gap: 20px;
      margin: 25px 0;
      flex-wrap: wrap;
    }
    
    .section {
      flex: 1;
      min-width: 450px;
      background: white;
      border: 2px solid #ddd;
      border-radius: 10px;
      padding: 20px;
      transition: all 0.3s;
    }
    .section:hover {
      border-color: #667eea;
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(102, 126, 234, 0.1);
    }
    .section h3 {
      text-align: center;
      margin-bottom: 25px;
      padding-bottom: 15px;
      border-bottom: 2px solid;
      font-size: 20px;
    }
    .section-1 h3 { color: #667eea; border-color: #667eea; }
    .section-2 h3 { color: #4CAF50; border-color: #4CAF50; }
    
    /* 입력 필드 스타일 */
    .input-controls {
      flex: 1;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .value-input {
      flex: 1;
      padding: 15px 20px;
      border: 3px solid #ddd;
      border-radius: 8px;
      font-size: 22px;
      font-weight: bold;
      transition: all 0.3s;
      background-color: #f9f9f9;
      box-sizing: border-box;
      height: 60px;
      text-align: center;
    }
    .value-input:focus {
      outline: none;
      border-color: #667eea;
      background-color: white;
      box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.2);
    }
    
    .btn-group {
      display: flex;
      gap: 8px;
    }
    .add-btn {
      padding: 12px 16px;
      background: #4CAF50;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.3s;
      font-size: 14px;
      min-width: 60px;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .add-btn:hover {
      background: #45a049;
      transform: scale(1.05);
    }
    .add-btn-special {
      background: #667eea;
    }
    .add-btn-special:hover {
      background: #5a67d8;
    }
    .negative-btn {
      background: #f44336;
    }
    .negative-btn:hover {
      background: #d32f2f;
    }
    .reset-btn {
      padding: 12px 16px;
      background: #9e9e9e;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.3s;
      font-size: 14px;
      min-width: 80px;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .reset-btn:hover {
      background: #757575;
    }
    
    .added-value {
      min-width: 80px;
      padding: 12px 16px;
      background: #e8f0fe;
      color: #667eea;
      border-radius: 25px;
      font-weight: bold;
      font-size: 16px;
      text-align: center;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .section-2 .added-value { background: #e8f5e8; color: #4CAF50; }
    
    .calculate-section {
      text-align: center;
      margin: 30px 0;
    }
    .calculate-btn {
      padding: 16px 30px;
      font-size: 18px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 30px;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.3s;
      min-width: 200px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      margin: 0 10px;
    }
    .calculate-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
    }
    
    /* 옵션 비교기 섹션 */
    .comparison-section {
      background: white;
      border-radius: 10px;
      padding: 25px;
      margin: 30px 0;
      border: 2px solid #2196F3;
    }
    .comparison-section h3 {
      color: #2196F3;
      border-color: #2196F3;
      margin-bottom: 25px;
    }
    
    .comparison-presets {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    
    .preset-item {
      background: #f8f9fa;
      border-radius: 10px;
      padding: 20px;
      border: 2px solid #e0e0e0;
      transition: all 0.3s;
      cursor: pointer;
    }
    .preset-item:hover {
      border-color: #2196F3;
      transform: translateY(-3px);
      box-shadow: 0 10px 20px rgba(33, 150, 243, 0.1);
    }
    .preset-item.active {
      border-color: #2196F3;
      background: #e3f2fd;
      box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.2);
    }
    
    .preset-title {
      font-size: 18px;
      font-weight: bold;
      color: #2196F3;
      margin-bottom: 15px;
      text-align: center;
    }
    
    .preset-options {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    
    .option-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 12px;
      background: white;
      border-radius: 6px;
      border-left: 4px solid #4CAF50;
    }
    .option-row:nth-child(2) { border-left-color: #ff9800; }
    .option-row:nth-child(3) { border-left-color: #f44336; }
    
    .option-name {
      font-weight: 600;
      color: #333;
    }
    
    .option-value {
      font-weight: bold;
      color: #2196F3;
      font-size: 16px;
    }
    
    .custom-comparison {
      background: #f5f7ff;
      border-radius: 10px;
      padding: 20px;
      margin-top: 20px;
    }
    
    .comparison-controls {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      margin-bottom: 20px;
      align-items: center;
      justify-content: center;
    }
    
    .comparison-input-group {
      display: flex;
      align-items: center;
      gap: 8px;
      background: white;
      padding: 10px 15px;
      border-radius: 8px;
      border: 2px solid #ddd;
    }
    
    .comparison-select {
      padding: 10px 15px;
      border: 2px solid #2196F3;
      border-radius: 6px;
      font-size: 14px;
      font-weight: bold;
      background: white;
      color: #333;
      min-width: 100px;
    }
    
    .add-option-btn {
      padding: 12px 20px;
      background: #4CAF50;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .add-option-btn:hover {
      background: #45a049;
    }
    
    .compare-btn {
      padding: 14px 30px;
      font-size: 16px;
      background: linear-gradient(135deg, #2196F3 0%, #0d47a1 100%);
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      gap: 10px;
      margin: 20px auto;
    }
    .compare-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 20px rgba(33, 150, 243, 0.3);
    }
    
    .comparison-result {
      display: none;
      margin-top: 30px;
      animation: fadeIn 0.5s;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .comparison-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    
    .comparison-table th {
      background: #2196F3;
      color: white;
      padding: 15px;
      text-align: center;
      font-size: 16px;
    }
    
    .comparison-table td {
      padding: 12px 15px;
      text-align: center;
      border-bottom: 1px solid #e0e0e0;
    }
    
    .comparison-table tr:nth-child(even) {
      background: #f9f9f9;
    }
    
    .comparison-table tr:hover {
      background: #f0f7ff;
    }
    
    .winner {
      background: #e8f5e9 !important;
      font-weight: bold;
      color: #2e7d32;
    }
    
    .damage-diff {
      font-weight: bold;
      font-size: 16px;
    }
    .damage-diff.positive {
      color: #4CAF50;
    }
    .damage-diff.negative {
      color: #f44336;
    }
    
    .efficiency-comparison {
      background: #fff8e1;
      border-radius: 10px;
      padding: 20px;
      margin-top: 25px;
      border: 2px solid #ffb74d;
      text-align: center;
    }
    
    .efficiency-title {
      font-size: 18px;
      font-weight: bold;
      color: #e65100;
      margin-bottom: 15px;
    }
    
    .efficiency-diff {
      font-size: 24px;
      font-weight: bold;
      color: #d84315;
      margin: 10px 0;
    }
    
    .efficiency-desc {
      font-size: 16px;
      color: #666;
      line-height: 1.5;
    }
    
    /* 상대적 효율 비교 섹션 추가 */
    .relative-efficiency {
      background: linear-gradient(135deg, #e1f5fe 0%, #b3e5fc 100%);
      border-radius: 10px;
      padding: 20px;
      margin-top: 25px;
      border: 2px solid #4fc3f7;
      text-align: center;
    }
    
    .relative-efficiency-title {
      font-size: 18px;
      font-weight: bold;
      color: #0277bd;
      margin-bottom: 15px;
    }
    
    .relative-efficiency-value {
      font-size: 28px;
      font-weight: bold;
      color: #01579b;
      margin: 10px 0;
    }
    
    .relative-efficiency-desc {
      font-size: 16px;
      color: #333;
      line-height: 1.5;
    }
    
    .relative-efficiency-note {
      font-size: 14px;
      color: #666;
      margin-top: 10px;
      font-style: italic;
    }
    
    .efficiency-highlight {
      background: linear-gradient(135deg, #fff9c4 0%, #fff59d 100%);
      padding: 5px 10px;
      border-radius: 5px;
      font-weight: bold;
      color: #ff8f00;
    }
    
    .result {
      background: #f8f9fa;
      border-radius: 10px;
      padding: 25px;
      margin-top: 25px;
      border: 2px solid #e9ecef;
    }
    
    .final-stats {
      background: white;
      border-radius: 10px;
      padding: 20px;
      margin: 20px 0;
      border: 2px solid #e3f2fd;
    }
    .final-stats h4 {
      color: #667eea;
      margin-top: 0;
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 20px;
      text-align: center;
      justify-content: center;
    }
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 15px;
      margin-top: 20px;
    }
    .stat-item {
      padding: 15px;
      background: #f5f7ff;
      border-radius: 8px;
      text-align: center;
    }
    .stat-label-sm {
      font-size: 14px;
      color: #666;
      margin-bottom: 8px;
    }
    .stat-value-sm {
      font-size: 18px;
      font-weight: bold;
      color: #333;
    }
    
    /* 딜상승량 분석 섹션 - 메달 스타일 */
    .damage-increase-section {
      background: white;
      border-radius: 10px;
      padding: 20px;
      margin: 20px 0;
      border: 2px solid #e8f5e9;
    }
    .damage-increase-section h4 {
      color: #4CAF50;
      margin-top: 0;
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 20px;
      text-align: center;
      justify-content: center;
    }
    .increase-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 15px;
      margin-top: 20px;
    }
    
    /* 메달 스타일 */
    .medal-gold {
      background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
      color: #8B4513;
      border: 3px solid #DAA520;
      animation: blink-gold 2s infinite;
    }
    .medal-silver {
      background: linear-gradient(135deg, #C0C0C0 0%, #A9A9A9 100%);
      color: #333;
      border: 3px solid #808080;
    }
    .medal-bronze {
      background: linear-gradient(135deg, #CD7F32 0%, #8B4513 100%);
      color: white;
      border: 3px solid #8B4513;
    }
    .medal-normal {
      background: linear-gradient(135deg, #f1f8e9 0%, #e8f5e8 100%);
      color: #333;
      border: 3px solid #4CAF50;
    }
    
    .increase-item {
      padding: 16px;
      border-radius: 12px;
      text-align: center;
      border-left: 5px solid;
      transition: transform 0.2s;
      position: relative;
      overflow: hidden;
    }
    .increase-item:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0,0,0,0.15);
    }
    
    /* 1등 빤짝임 효과 */
    @keyframes blink-gold {
      0%, 100% { box-shadow: 0 0 10px #FFD700; }
      50% { box-shadow: 0 0 20px #FFD700, 0 0 30px #FFA500; }
    }
    
    .rank-badge {
      position: absolute;
      top: 8px;
      right: 8px;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 14px;
    }
    .rank-1 {
      background: #FFD700;
      color: #8B4513;
    }
    .rank-2 {
      background: #C0C0C0;
      color: #333;
    }
    .rank-3 {
      background: #CD7F32;
      color: white;
    }
    
    .increase-label {
      font-size: 16px;
      color: inherit;
      margin-bottom: 8px;
      font-weight: bold;
    }
    .increase-value {
      font-size: 22px;
      font-weight: bold;
      color: inherit;
    }
    .increase-note {
      font-size: 14px;
      color: inherit;
      margin-top: 5px;
      opacity: 0.9;
    }
    
    .damage-result {
      text-align: center;
      padding: 25px;
      background: white;
      border-radius: 10px;
      border: 3px solid;
      border-image: linear-gradient(135deg, #667eea 0%, #764ba2 100%) 1;
    }
    .damage-item {
      margin: 18px 0;
      padding: 18px;
      background: #f8f9fa;
      border-radius: 10px;
      border-left: 5px solid;
    }
    .damage-main { border-left-color: #667eea; }
    .damage-plus5 { border-left-color: #4CAF50; }
    .damage-minus5 { border-left-color: #f44336; }
    .damage-label {
      font-size: 16px;
      color: #666;
      margin-bottom: 8px;
    }
    .damage-value {
      font-size: 28px;
      font-weight: bold;
      color: #333;
    }
    
    .formula-section {
      background: #f5f7ff;
      padding: 15px;
      border-radius: 8px;
      margin: 15px 0;
      font-size: 15px;
      text-align: center;
    }
    
    /* 모바일 대응 */
    @media (max-width: 1000px) {
      .sections-container {
        flex-direction: column;
      }
      .section {
        min-width: 100%;
      }
      .comparison-presets {
        grid-template-columns: 1fr;
      }
      .comparison-controls {
        flex-direction: column;
      }
    }
    
    @media (max-width: 768px) {
      .stat-row {
        flex-direction: column;
        align-items: stretch;
        gap: 10px;
      }
      .stat-label {
        text-align: left;
        min-width: auto;
      }
      .input-controls {
        flex-direction: column;
        gap: 10px;
      }
      .value-input {
        width: 100%;
        font-size: 20px;
        height: 55px;
      }
      .btn-group {
        width: 100%;
        justify-content: center;
      }
      .add-btn, .reset-btn {
        flex: 1;
        height: 50px;
      }
      .added-value {
        width: 100%;
        height: 50px;
      }
      .calculate-btn {
        min-width: 160px;
        padding: 14px 25px;
        font-size: 16px;
        margin: 5px;
      }
      .comparison-input-group {
        width: 100%;
      }
    }
    
    @media (max-width: 480px) {
      .container {
        padding: 15px;
      }
      .value-input {
        font-size: 18px;
        height: 50px;
        padding: 12px 15px;
      }
      .added-value {
        font-size: 14px;
        padding: 10px;
        height: 45px;
      }
      .add-btn, .reset-btn {
        font-size: 13px;
        padding: 10px 12px;
        height: 45px;
      }
      .increase-grid {
        grid-template-columns: 1fr;
      }
      .comparison-table {
        font-size: 14px;
      }
      .comparison-table th, 
      .comparison-table td {
        padding: 8px 10px;
      }
    }
  </style>
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>

<div class="container">
  <h1><i class="fas fa-calculator"></i> 게임 대미지 계산기 + 옵션 비교기</h1>
  
  <div class="alert-section">
    <strong><i class="fas fa-exclamation-triangle"></i> 계산 전 확인 사항:</strong>
    <p>다음 요소들이 계산에 포함되었는지 확인해 주세요:</p>
    <ul>
      <li>보스에 적용된 디버프 (방어율 감소, 방어력 감소 등)</li>
      <li>V매트릭스 (코어 강화, 스킬 효과 등)</li>
      <li>헥사 스킬 (스킬 코어, 강화 효과 등)</li>
      <li>시아링크 (링크 스킬 효과)</li>
      <li>보조무기/보조 장비 (보슬, 에디셔널 잠재능력 등)</li>
      <li>유니온 공격대 효과 및 유니온 레벨</li>
    </ul>
    <p>위 요소들이 기본스텟, 도핑 중 적절한 섹션에 입력되었는지 다시 한번 확인하세요.</p>
  </div>
  
  <div class="formula-section">
    <strong>계산식:</strong> 깡공 × (물공% + 스댐% × (1 + 보공%)) × (1 + 물댐%) × (1.2 + 치피%) × (1 + 종댐%) ±5%(최대 최소댐)
  </div>

  <div class="sections-container">
    <!-- 기본스텟 섹션 -->
    <div class="section section-1">
      <h3><i class="fas fa-user"></i> 기본스텟</h3>
      
      <div class="stat-row">
        <div class="stat-label">깡공</div>
        <div class="input-controls">
          <input id="a-base" type="number" step="any" value="3000" class="value-input">
          <div class="btn-group">
            <button class="add-btn add-btn-special" onclick="addValue('a', 100, 'base')">+100</button>
            <button class="add-btn negative-btn" onclick="addValue('a', -100, 'base')">-100</button>
          </div>
          <span class="added-value" id="a-base-added">+0</span>
        </div>
      </div>
      
      <div class="stat-row">
        <div class="stat-label">물공%</div>
        <div class="input-controls">
          <input id="b-base" type="number" step="any" value="100" class="value-input">
          <div class="btn-group">
            <button class="add-btn" onclick="addValue('b', 5, 'base')">+5</button>
            <button class="add-btn negative-btn" onclick="addValue('b', -5, 'base')">-5</button>
            <button class="reset-btn" onclick="resetValue('b', 'base')">초기화</button>
          </div>
          <span class="added-value" id="b-base-added">+0</span>
        </div>
      </div>
      
      <div class="stat-row">
        <div class="stat-label">스댐%</div>
        <div class="input-controls">
          <input id="c-base" type="number" step="any" value="50" class="value-input">
          <div class="btn-group">
            <button class="add-btn" onclick="addValue('c', 5, 'base')">+5</button>
            <button class="add-btn negative-btn" onclick="addValue('c', -5, 'base')">-5</button>
            <button class="reset-btn" onclick="resetValue('c', 'base')">초기화</button>
          </div>
          <span class="added-value" id="c-base-added">+0</span>
        </div>
      </div>
      
      <div class="stat-row">
        <div class="stat-label">보공%</div>
        <div class="input-controls">
          <input id="d-base" type="number" step="any" value="100" class="value-input">
          <div class="btn-group">
            <button class="add-btn" onclick="addValue('d', 5, 'base')">+5</button>
            <button class="add-btn negative-btn" onclick="addValue('d', -5, 'base')">-5</button>
            <button class="reset-btn" onclick="resetValue('d', 'base')">초기화</button>
          </div>
          <span class="added-value" id="d-base-added">+0</span>
        </div>
      </div>
      
      <div class="stat-row">
        <div class="stat-label">물댐%</div>
        <div class="input-controls">
          <input id="e-base" type="number" step="any" value="30" class="value-input">
          <div class="btn-group">
            <button class="add-btn" onclick="addValue('e', 5, 'base')">+5</button>
            <button class="add-btn negative-btn" onclick="addValue('e', -5, 'base')">-5</button>
            <button class="reset-btn" onclick="resetValue('e', 'base')">초기화</button>
          </div>
          <span class="added-value" id="e-base-added">+0</span>
        </div>
      </div>
      
      <div class="stat-row">
        <div class="stat-label">치피%</div>
        <div class="input-controls">
          <input id="f-base" type="number" step="any" value="50" class="value-input">
          <div class="btn-group">
            <button class="add-btn" onclick="addValue('f', 5, 'base')">+5</button>
            <button class="add-btn negative-btn" onclick="addValue('f', -5, 'base')">-5</button>
            <button class="reset-btn" onclick="resetValue('f', 'base')">초기화</button>
          </div>
          <span class="added-value" id="f-base-added">+0</span>
        </div>
      </div>
      
      <div class="stat-row">
        <div class="stat-label">종댐%</div>
        <div class="input-controls">
          <input id="g-base" type="number" step="any" value="40" class="value-input">
          <div class="btn-group">
            <button class="add-btn" onclick="addValue('g', 5, 'base')">+5</button>
            <button class="add-btn negative-btn" onclick="addValue('g', -5, 'base')">-5</button>
            <button class="reset-btn" onclick="resetValue('g', 'base')">초기화</button>
          </div>
          <span class="added-value" id="g-base-added">+0</span>
        </div>
      </div>
    </div>

    <!-- 도핑 섹션 -->
    <div class="section section-2">
      <h3><i class="fas fa-flask"></i> 도핑</h3>
      
      <div class="stat-row">
        <div class="stat-label">깡공</div>
        <div class="input-controls">
          <input id="a-doping" type="number" step="any" value="0" class="value-input">
          <div class="btn-group">
            <button class="add-btn add-btn-special" onclick="addValue('a', 100, 'doping')">+100</button>
            <button class="add-btn negative-btn" onclick="addValue('a', -100, 'doping')">-100</button>
          </div>
          <span class="added-value" id="a-doping-added">+0</span>
        </div>
      </div>
      
      <div class="stat-row">
        <div class="stat-label">물공%</div>
        <div class="input-controls">
          <input id="b-doping" type="number" step="any" value="0" class="value-input">
          <div class="btn-group">
            <button class="add-btn" onclick="addValue('b', 5, 'doping')">+5</button>
            <button class="add-btn negative-btn" onclick="addValue('b', -5, 'doping')">-5</button>
            <button class="reset-btn" onclick="resetValue('b', 'doping')">초기화</button>
          </div>
          <span class="added-value" id="b-doping-added">+0</span>
        </div>
      </div>
      
      <div class="stat-row">
        <div class="stat-label">스댐%</div>
        <div class="input-controls">
          <input id="c-doping" type="number" step="any" value="0" class="value-input">
          <div class="btn-group">
            <button class="add-btn" onclick="addValue('c', 5, 'doping')">+5</button>
            <button class="add-btn negative-btn" onclick="addValue('c', -5, 'doping')">-5</button>
            <button class="reset-btn" onclick="resetValue('c', 'doping')">초기화</button>
          </div>
          <span class="added-value" id="c-doping-added">+0</span>
        </div>
      </div>
      
      <div class="stat-row">
        <div class="stat-label">보공%</div>
        <div class="input-controls">
          <input id="d-doping" type="number" step="any" value="0" class="value-input">
          <div class="btn-group">
            <button class="add-btn" onclick="addValue('d', 5, 'doping')">+5</button>
            <button class="add-btn negative-btn" onclick="addValue('d', -5, 'doping')">-5</button>
            <button class="reset-btn" onclick="resetValue('d', 'doping')">초기화</button>
          </div>
          <span class="added-value" id="d-doping-added">+0</span>
        </div>
      </div>
      
      <div class="stat-row">
        <div class="stat-label">물댐%</div>
        <div class="input-controls">
          <input id="e-doping" type="number" step="any" value="0" class="value-input">
          <div class="btn-group">
            <button class="add-btn" onclick="addValue('e', 5, 'doping')">+5</button>
            <button class="add-btn negative-btn" onclick="addValue('e', -5, 'doping')">-5</button>
            <button class="reset-btn" onclick="resetValue('e', 'doping')">초기화</button>
          </div>
          <span class="added-value" id="e-doping-added">+0</span>
        </div>
      </div>
      
      <div class="stat-row">
        <div class="stat-label">치피%</div>
        <div class="input-controls">
          <input id="f-doping" type="number" step="any" value="0" class="value-input">
          <div class="btn-group">
            <button class="add-btn" onclick="addValue('f', 5, 'doping')">+5</button>
            <button class="add-btn negative-btn" onclick="addValue('f', -5, 'doping')">-5</button>
            <button class="reset-btn" onclick="resetValue('f', 'doping')">초기화</button>
          </div>
          <span class="added-value" id="f-doping-added">+0</span>
        </div>
      </div>
      
      <div class="stat-row">
        <div class="stat-label">종댐%</div>
        <div class="input-controls">
          <input id="g-doping" type="number" step="any" value="0" class="value-input">
          <div class="btn-group">
            <button class="add-btn" onclick="addValue('g', 5, 'doping')">+5</button>
            <button class="add-btn negative-btn" onclick="addValue('g', -5, 'doping')">-5</button>
            <button class="reset-btn" onclick="resetValue('g', 'doping')">초기화</button>
          </div>
          <span class="added-value" id="g-doping-added">+0</span>
        </div>
      </div>
    </div>
  </div>

  <!-- 옵션 비교기 섹션 -->
  <div class="comparison-section">
    <h3><i class="fas fa-balance-scale"></i> 옵션 비교기</h3>
    <p style="text-align: center; color: #666; margin-bottom: 20px;">현재 스텟을 기반으로 다양한 옵션 조합의 효율을 비교해보세요</p>
    
    <div class="comparison-presets">
      <!-- 프리셋 1: 보공 vs 치피+물공 -->
      <div class="preset-item active" onclick="selectPreset(1)">
        <div class="preset-title">보공 vs 치피+물공</div>
        <div class="preset-options">
          <div class="option-row">
            <div class="option-name">옵션 A:</div>
            <div class="option-value">보공 8%</div>
          </div>
          <div class="option-row">
            <div class="option-name">옵션 B:</div>
            <div class="option-value">치피 6% + 물공 15%</div>
          </div>
          <div class="option-row">
            <div class="option-name">현재 스텟 기준</div>
            <div class="option-value">비교하기</div>
          </div>
        </div>
      </div>
      
      <!-- 프리셋 2: 깡공 vs 치피 -->
      <div class="preset-item" onclick="selectPreset(2)">
        <div class="preset-title">깡공 vs 치피</div>
        <div class="preset-options">
          <div class="option-row">
            <div class="option-name">옵션 A:</div>
            <div class="option-value">깡공 1000</div>
          </div>
          <div class="option-row">
            <div class="option-name">옵션 B:</div>
            <div class="option-value">치피 10%</div>
          </div>
          <div class="option-row">
            <div class="option-name">현재 스텟 기준</div>
            <div class="option-value">비교하기</div>
          </div>
        </div>
      </div>
      
      <!-- 프리셋 3: 종댐+물공 vs 치피 -->
      <div class="preset-item" onclick="selectPreset(3)">
        <div class="preset-title">종댐+물공 vs 치피</div>
        <div class="preset-options">
          <div class="option-row">
            <div class="option-name">옵션 A:</div>
            <div class="option-value">종댐 7% + 물공 12%</div>
          </div>
          <div class="option-row">
            <div class="option-name">옵션 B:</div>
            <div class="option-value">치피 8%</div>
          </div>
          <div class="option-row">
            <div class="option-name">현재 스텟 기준</div>
            <div class="option-value">비교하기</div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="custom-comparison">
      <h4 style="text-align: center; color: #555; margin-bottom: 20px;">직접 옵션 비교하기 (최대 3가지 옵션)</h4>
      
      <div class="comparison-controls">
        <!-- 옵션 A -->
        <div class="comparison-input-group">
          <span style="font-weight: bold;">옵션 A:</span>
          <select id="custom-stat-1" class="comparison-select">
            <option value="a">깡공</option>
            <option value="b">물공%</option>
            <option value="c">스댐%</option>
            <option value="d" selected>보공%</option>
            <option value="e">물댐%</option>
            <option value="f">치피%</option>
            <option value="g">종댐%</option>
          </select>
          <input id="custom-value-1" type="number" value="8" min="1" max="1000" class="value-input" style="width: 80px; font-size: 16px; padding: 8px;">
          <span style="font-weight: bold;" id="unit-1">%</span>
        </div>
        
        <!-- 옵션 A 추가 -->
        <div class="comparison-input-group" id="option-a-extra" style="display: none;">
          <span style="font-weight: bold;">+</span>
          <select id="custom-stat-1b" class="comparison-select">
            <option value="a">깡공</option>
            <option value="b">물공%</option>
            <option value="c">스댐%</option>
            <option value="d">보공%</option>
            <option value="e">물댐%</option>
            <option value="f">치피%</option>
            <option value="g">종댐%</option>
          </select>
          <input id="custom-value-1b" type="number" value="0" min="0" max="100" class="value-input" style="width: 80px; font-size: 16px; padding: 8px;">
          <span style="font-weight: bold;" id="unit-1b">%</span>
          <button onclick="removeOption('a-extra')" style="background: #f44336; color: white; border: none; border-radius: 4px; padding: 5px 10px; cursor: pointer;">X</button>
        </div>
        
        <button onclick="addExtraOption('a')" class="add-option-btn">
          <i class="fas fa-plus"></i> 추가
        </button>
        
        <span style="font-weight: bold; font-size: 18px;">VS</span>
        
        <!-- 옵션 B -->
        <div class="comparison-input-group">
          <span style="font-weight: bold;">옵션 B:</span>
          <select id="custom-stat-2" class="comparison-select">
            <option value="a">깡공</option>
            <option value="b" selected>물공%</option>
            <option value="c">스댐%</option>
            <option value="d">보공%</option>
            <option value="e">물댐%</option>
            <option value="f">치피%</option>
            <option value="g">종댐%</option>
          </select>
          <input id="custom-value-2" type="number" value="15" min="1" max="1000" class="value-input" style="width: 80px; font-size: 16px; padding: 8px;">
          <span style="font-weight: bold;" id="unit-2">%</span>
        </div>
        
        <!-- 옵션 B 추가 -->
        <div class="comparison-input-group" id="option-b-extra">
          <span style="font-weight: bold;">+</span>
          <select id="custom-stat-2b" class="comparison-select">
            <option value="a">깡공</option>
            <option value="b">물공%</option>
            <option value="c">스댐%</option>
            <option value="d">보공%</option>
            <option value="e">물댐%</option>
            <option value="f" selected>치피%</option>
            <option value="g">종댐%</option>
          </select>
          <input id="custom-value-2b" type="number" value="6" min="0" max="100" class="value-input" style="width: 80px; font-size: 16px; padding: 8px;">
          <span style="font-weight: bold;" id="unit-2b">%</span>
          <button onclick="removeOption('b-extra')" style="background: #f44336; color: white; border: none; border-radius: 4px; padding: 5px 10px; cursor: pointer;">X</button>
        </div>
        
        <button onclick="addExtraOption('b')" class="add-option-btn">
          <i class="fas fa-plus"></i> 추가
        </button>
      </div>
      
      <button class="compare-btn" onclick="compareOptions()">
        <i class="fas fa-balance-scale"></i> 옵션 비교하기
      </button>
    </div>
    
    <div class="comparison-result" id="comparison-result">
      <h4 style="text-align: center; color: #2196F3; margin-bottom: 10px;">비교 결과</h4>
      <div id="comparison-description" style="text-align: center; margin-bottom: 20px; color: #666;"></div>
      
      <div class="efficiency-comparison" id="efficiency-summary">
        <div class="efficiency-title">효율 비교 결과</div>
        <div class="efficiency-diff" id="efficiency-diff">0.00% 차이</div>
        <div class="efficiency-desc" id="efficiency-desc">
          두 옵션이 동일한 효율을 가집니다.
        </div>
      </div>
      
      <!-- 상대적 효율 비교 섹션 추가 -->
      <div class="relative-efficiency" id="relative-efficiency-section" style="display: none;">
        <div class="relative-efficiency-title">
          <i class="fas fa-chart-line"></i> 상대적 효율 비교
        </div>
        <div class="relative-efficiency-value" id="relative-efficiency-value">
          0.00%
        </div>
        <div class="relative-efficiency-desc" id="relative-efficiency-desc">
          두 옵션의 상대적 효율 차이
        </div>
        <div class="relative-efficiency-note" id="relative-efficiency-note">
          계산식: (승자 딜상승량 ÷ 패자 딜상승량 × 100) - 100
        </div>
      </div>
      
      <table class="comparison-table" id="comparison-table">
        <thead>
          <tr>
            <th>옵션</th>
            <th>대미지</th>
            <th>딜상승량</th>
            <th>차이</th>
            <th>결과</th>
          </tr>
        </thead>
        <tbody id="comparison-table-body">
          <!-- 결과가 여기에 표시됩니다 -->
        </tbody>
      </table>
    </div>
  </div>

  <div class="calculate-section">
    <button class="calculate-btn" onclick="calculate()">
      <i class="fas fa-bolt"></i> 대미지 계산하기
    </button>
    <button class="calculate-btn" onclick="clearAll()" style="background: #f44336; margin-left: 10px;">
      <i class="fas fa-trash"></i> 모두 초기화
    </button>
  </div>

  <div class="result">
    <div class="final-stats">
      <h4><i class="fas fa-chart-bar"></i> 최종 스텟 (암묵적 합산)</h4>
      <div class="stats-grid" id="final-stats"></div>
    </div>
    
    <div class="damage-increase-section" id="damage-increase">
      <h4><i class="fas fa-trophy"></i> 스텟 효율 순위 (1%당 딜상승량)</h4>
      <p style="text-align: center; color: #666; margin-bottom: 15px;">각 스텟을 1% 증가시켰을 때의 딜상승량 (깡공은 300 증가 기준)</p>
      <div class="increase-grid" id="increase-grid"></div>
    </div>
    
    <div id="damage-output">
      <h3><i class="fas fa-bullseye"></i> 대미지 계산 결과</h3>
      <p style="text-align: center; color: #666;">계산 버튼을 눌러 결과를 확인하세요</p>
    </div>
  </div>
</div>

<script>
// 각 섹션별 추가된 누적값을 저장할 객체
const addedValues = {
  base: { a: 0, b: 0, c: 0, d: 0, e: 0, f: 0, g: 0 },
  doping: { a: 0, b: 0, c: 0, d: 0, e: 0, f: 0, g: 0 }
};

// 스텟 이름 매핑
const statNames = {
  a: { name: '깡공', unit: '' },
  b: { name: '물공%', unit: '%' },
  c: { name: '스댐%', unit: '%' },
  d: { name: '보공%', unit: '%' },
  e: { name: '물댐%', unit: '%' },
  f: { name: '치피%', unit: '%' },
  g: { name: '종댐%', unit: '%' }
};

// 현재 선택된 프리셋
let currentPreset = 1;

// 프리셋 데이터
const presets = {
  1: {
    title: "보공 vs 치피+물공",
    options: [
      { stats: [{type: 'd', value: 8}] },
      { stats: [{type: 'f', value: 6}, {type: 'b', value: 15}] }
    ]
  },
  2: {
    title: "깡공 vs 치피",
    options: [
      { stats: [{type: 'a', value: 1000}] },
      { stats: [{type: 'f', value: 10}] }
    ]
  },
  3: {
    title: "종댐+물공 vs 치피",
    options: [
      { stats: [{type: 'g', value: 7}, {type: 'b', value: 12}] },
      { stats: [{type: 'f', value: 8}] }
    ]
  }
};

// 기본값 가져오기
function getDefaultValue(type, section) {
  const defaults = {
    base: { a: 3000, b: 100, c: 50, d: 100, e: 30, f: 50, g: 40 },
    doping: { a: 0, b: 0, c: 0, d: 0, e: 0, f: 0, g: 0 }
  };
  return defaults[section][type] || 0;
}

// + 버튼 함수
function addValue(type, amount, section) {
  const inputId = `${type}-${section}`;
  const input = document.getElementById(inputId);
  const addedDisplay = document.getElementById(`${inputId}-added`);
  
  const currentValue = Number(input.value) || 0;
  const newValue = currentValue + amount;
  input.value = newValue < 0 ? 0 : newValue;
  
  const defaultValue = getDefaultValue(type, section);
  addedValues[section][type] = (Number(input.value) || 0) - defaultValue;
  addedDisplay.textContent = `${addedValues[section][type] > 0 ? '+' : ''}${addedValues[section][type]}`;
  
  updateTotalAdded();
}

// 값 초기화 함수
function resetValue(type, section) {
  const inputId = `${type}-${section}`;
  const input = document.getElementById(inputId);
  const addedDisplay = document.getElementById(`${inputId}-added`);
  
  const defaultValue = getDefaultValue(type, section);
  input.value = defaultValue;
  addedValues[section][type] = 0;
  addedDisplay.textContent = '+0';
  
  updateTotalAdded();
}

// 모두 초기화
function clearAll() {
  if (!confirm('모든 입력값을 초기화하시겠습니까?')) return;
  
  const sections = ['base', 'doping'];
  sections.forEach(section => {
    Object.keys(addedValues[section]).forEach(type => {
      const inputId = `${type}-${section}`;
      const input = document.getElementById(inputId);
      const addedDisplay = document.getElementById(`${inputId}-added`);
      
      const defaultValue = getDefaultValue(type, section);
      input.value = defaultValue;
      addedValues[section][type] = 0;
      addedDisplay.textContent = '+0';
    });
  });
  
  document.getElementById('damage-output').innerHTML = `
    <h3><i class="fas fa-bullseye"></i> 대미지 계산 결과</h3>
    <p style="text-align: center; color: #666;">계산 버튼을 눌러 결과를 확인하세요</p>
  `;
  
  document.getElementById('final-stats').innerHTML = '';
  document.getElementById('increase-grid').innerHTML = '';
  document.getElementById('comparison-result').style.display = 'none';
  document.getElementById('relative-efficiency-section').style.display = 'none';
  
  updateTotalAdded();
}

// 추가된 수치 요약 업데이트
function updateTotalAdded() {
  const sections = [
    { id: 'base', element: '.section-1' },
    { id: 'doping', element: '.section-2' }
  ];
  
  sections.forEach(({ id, element }) => {
    const sectionData = addedValues[id];
    const hasChanges = Object.values(sectionData).some(value => value !== 0);
    const sectionEl = document.querySelector(element);
    
    if (sectionEl) {
      if (hasChanges) {
        const color = id === 'base' ? '#667eea' : id === 'doping' ? '#4CAF50' : '#FF9800';
        sectionEl.style.boxShadow = `0 0 0 3px ${color}`;
      } else {
        sectionEl.style.boxShadow = '';
      }
    }
  });
}

// 대미지 계산 함수
function calculateDamage(values) {
  return values.a * 
         (values.b/100 + values.c/100 * (1 + values.d/100)) * 
         (1 + values.e/100) * 
         (1.2 + values.f/100) * 
         (1 + values.g/100);
}

// 스텟별 1%당 딜상승량 계산
function calculateDamageIncrease(baseValues) {
  const baseDamage = calculateDamage(baseValues);
  const increases = {};
  
  // 깡공 300 증가시
  const tempValuesA = {...baseValues};
  tempValuesA.a += 300;
  increases.a = (calculateDamage(tempValuesA) - baseDamage) / baseDamage * 100;
  
  // 물공% 1% 증가시
  const tempValuesB = {...baseValues};
  tempValuesB.b += 1;
  increases.b = (calculateDamage(tempValuesB) - baseDamage) / baseDamage * 100;
  
  // 스댐% 1% 증가시
  const tempValuesC = {...baseValues};
  tempValuesC.c += 1;
  increases.c = (calculateDamage(tempValuesC) - baseDamage) / baseDamage * 100;
  
  // 보공% 1% 증가시
  const tempValuesD = {...baseValues};
  tempValuesD.d += 1;
  increases.d = (calculateDamage(tempValuesD) - baseDamage) / baseDamage * 100;
  
  // 물댐% 1% 증가시
  const tempValuesE = {...baseValues};
  tempValuesE.e += 1;
  increases.e = (calculateDamage(tempValuesE) - baseDamage) / baseDamage * 100;
  
  // 치피% 1% 증가시
  const tempValuesF = {...baseValues};
  tempValuesF.f += 1;
  increases.f = (calculateDamage(tempValuesF) - baseDamage) / baseDamage * 100;
  
  // 종댐% 1% 증가시
  const tempValuesG = {...baseValues};
  tempValuesG.g += 1;
  increases.g = (calculateDamage(tempValuesG) - baseDamage) / baseDamage * 100;
  
  return increases;
}

// 딜상승량 순위 매기기
function getRankedIncreases(increases) {
  const stats = [
    {id: 'a', name: '깡공 300', value: increases.a, unit: '300'},
    {id: 'b', name: '물공%', value: increases.b, unit: '1%'},
    {id: 'c', name: '스댐%', value: increases.c, unit: '1%'},
    {id: 'd', name: '보공%', value: increases.d, unit: '1%'},
    {id: 'e', name: '물댐%', value: increases.e, unit: '1%'},
    {id: 'f', name: '치피%', value: increases.f, unit: '1%'},
    {id: 'g', name: '종댐%', value: increases.g, unit: '1%'}
  ];
  
  return stats.sort((a, b) => b.value - a.value);
}

// 딜상승량 표시 (메달 스타일)
function displayDamageIncrease(increases, baseDamage) {
  const rankedStats = getRankedIncreases(increases);
  
  let html = '';
  rankedStats.forEach((stat, index) => {
    let medalClass = 'medal-normal';
    let rankClass = '';
    let rankText = '';
    
    // 1, 2, 3등에 메달 스타일 적용
    if (index === 0) {
      medalClass = 'medal-gold';
      rankClass = 'rank-1';
      rankText = '1';
    } else if (index === 1) {
      medalClass = 'medal-silver';
      rankClass = 'rank-2';
      rankText = '2';
    } else if (index === 2) {
      medalClass = 'medal-bronze';
      rankClass = 'rank-3';
      rankText = '3';
    }
    
    html += `
      <div class="increase-item ${medalClass}">
        ${rankText ? `<div class="rank-badge ${rankClass}">${rankText}</div>` : ''}
        <div class="increase-label">${stat.name}</div>
        <div class="increase-value">+${stat.value.toFixed(3)}%</div>
        <div class="increase-note">${stat.unit} 증가시</div>
      </div>
    `;
  });
  
  document.getElementById("increase-grid").innerHTML = html;
}

// 프리셋 선택
function selectPreset(presetId) {
  currentPreset = presetId;
  
  // 모든 프리셋 아이템에서 active 클래스 제거
  document.querySelectorAll('.preset-item').forEach(item => {
    item.classList.remove('active');
  });
  
  // 선택한 프리셋에 active 클래스 추가
  event.currentTarget.classList.add('active');
  
  // 프리셋 데이터로 입력 필드 채우기
  const preset = presets[presetId];
  if (presetId === 1) {
    // 보공 8% vs 치피 6% + 물공 15%
    document.getElementById('custom-stat-1').value = 'd';
    document.getElementById('custom-value-1').value = 8;
    updateUnitDisplay('1');
    document.getElementById('option-a-extra').style.display = 'none';
    
    document.getElementById('custom-stat-2').value = 'f';
    document.getElementById('custom-value-2').value = 6;
    updateUnitDisplay('2');
    document.getElementById('custom-stat-2b').value = 'b';
    document.getElementById('custom-value-2b').value = 15;
    updateUnitDisplay('2b');
    document.getElementById('option-b-extra').style.display = 'flex';
  } else if (presetId === 2) {
    // 깡공 1000 vs 치피 10%
    document.getElementById('custom-stat-1').value = 'a';
    document.getElementById('custom-value-1').value = 1000;
    updateUnitDisplay('1');
    document.getElementById('option-a-extra').style.display = 'none';
    
    document.getElementById('custom-stat-2').value = 'f';
    document.getElementById('custom-value-2').value = 10;
    updateUnitDisplay('2');
    document.getElementById('custom-stat-2b').value = 'b';
    document.getElementById('custom-value-2b').value = 0;
    document.getElementById('option-b-extra').style.display = 'none';
  } else if (presetId === 3) {
    // 종댐 7% + 물공 12% vs 치피 8%
    document.getElementById('custom-stat-1').value = 'g';
    document.getElementById('custom-value-1').value = 7;
    updateUnitDisplay('1');
    document.getElementById('custom-stat-1b').value = 'b';
    document.getElementById('custom-value-1b').value = 12;
    updateUnitDisplay('1b');
    document.getElementById('option-a-extra').style.display = 'flex';
    
    document.getElementById('custom-stat-2').value = 'f';
    document.getElementById('custom-value-2').value = 8;
    updateUnitDisplay('2');
    document.getElementById('custom-stat-2b').value = 'b';
    document.getElementById('custom-value-2b').value = 0;
    document.getElementById('option-b-extra').style.display = 'none';
  }
}

// 단위 업데이트 함수
function updateUnitDisplay(inputId) {
  const selectElement = document.getElementById(`custom-stat-${inputId}`);
  const unitElement = document.getElementById(`unit-${inputId}`);
  const statType = selectElement.value;
  
  if (statType === 'a') {
    unitElement.textContent = '';
  } else {
    unitElement.textContent = '%';
  }
}

// 추가 옵션 추가 함수
function addExtraOption(optionType) {
  const extraDiv = document.getElementById(`option-${optionType}-extra`);
  if (extraDiv.style.display === 'none') {
    extraDiv.style.display = 'flex';
  } else {
    // 이미 추가되어 있으면 새로운 추가 옵션을 만들 수도 있음
    alert('이미 추가 옵션이 있습니다. 먼저 기존 옵션을 제거해주세요.');
  }
}

// 옵션 제거 함수
function removeOption(optionType) {
  const extraDiv = document.getElementById(`option-${optionType}`);
  extraDiv.style.display = 'none';
  // 값 초기화
  if (optionType === 'a-extra') {
    document.getElementById('custom-value-1b').value = 0;
  } else if (optionType === 'b-extra') {
    document.getElementById('custom-value-2b').value = 0;
  }
}

// 옵션 비교 함수 - 상대적 효율 추가
function compareOptions() {
  // 현재 스텟값 가져오기
  const sections = ['base', 'doping'];
  const currentValues = {};
  
  ['a', 'b', 'c', 'd', 'e', 'f', 'g'].forEach(type => {
    currentValues[type] = 0;
    sections.forEach(section => {
      const inputId = `${type}-${section}`;
      const inputValue = Number(document.getElementById(inputId).value) || 0;
      currentValues[type] += inputValue;
    });
  });
  
  // 기본 대미지 계산
  const baseDamage = calculateDamage(currentValues);
  
  // 옵션 A 가져오기
  const option1Stat = document.getElementById('custom-stat-1').value;
  const option1Value = Number(document.getElementById('custom-value-1').value) || 0;
  const option1ExtraStat = document.getElementById('custom-stat-1b').value;
  const option1ExtraValue = Number(document.getElementById('custom-value-1b').value) || 0;
  const hasOption1Extra = document.getElementById('option-a-extra').style.display !== 'none' && option1ExtraValue > 0;
  
  // 옵션 B 가져오기
  const option2Stat = document.getElementById('custom-stat-2').value;
  const option2Value = Number(document.getElementById('custom-value-2').value) || 0;
  const option2ExtraStat = document.getElementById('custom-stat-2b').value;
  const option2ExtraValue = Number(document.getElementById('custom-value-2b').value) || 0;
  const hasOption2Extra = document.getElementById('option-b-extra').style.display !== 'none' && option2ExtraValue > 0;
  
  // 옵션 A 적용 후 대미지 계산
  const option1Values = {...currentValues};
  option1Values[option1Stat] += option1Value;
  if (hasOption1Extra) {
    option1Values[option1ExtraStat] += option1ExtraValue;
  }
  const option1Damage = calculateDamage(option1Values);
  const option1Increase = ((option1Damage - baseDamage) / baseDamage * 100);
  
  // 옵션 B 적용 후 대미지 계산
  const option2Values = {...currentValues};
  option2Values[option2Stat] += option2Value;
  if (hasOption2Extra) {
    option2Values[option2ExtraStat] += option2ExtraValue;
  }
  const option2Damage = calculateDamage(option2Values);
  const option2Increase = ((option2Damage - baseDamage) / baseDamage * 100);
  
  // 결과 비교
  let winner = '';
  let loser = '';
  let diff = 0;
  let diffPercent = 0;
  let relativeEfficiency = 0;
  let winnerIncrease = 0;
  let loserIncrease = 0;
  
  if (option1Increase > option2Increase) {
    winner = '옵션 A';
    loser = '옵션 B';
    diff = option1Increase - option2Increase;
    diffPercent = (option1Damage / option2Damage * 100) - 100;
    winnerIncrease = option1Increase;
    loserIncrease = option2Increase;
    // 상대적 효율 차이 계산: (승자딜상승량 / 패자딜상승량 * 100) - 100
    relativeEfficiency = (option1Increase / option2Increase * 100) - 100;
  } else if (option2Increase > option1Increase) {
    winner = '옵션 B';
    loser = '옵션 A';
    diff = option2Increase - option1Increase;
    diffPercent = (option2Damage / option1Damage * 100) - 100;
    winnerIncrease = option2Increase;
    loserIncrease = option1Increase;
    // 상대적 효율 차이 계산
    relativeEfficiency = (option2Increase / option1Increase * 100) - 100;
  } else {
    winner = '동일';
    diff = 0;
    diffPercent = 0;
    relativeEfficiency = 0;
  }
  
  // 결과 표시
  const option1Name = statNames[option1Stat].name;
  const option1Unit = option1Stat === 'a' ? '' : '%';
  const option1ExtraName = hasOption1Extra ? statNames[option1ExtraStat].name : '';
  const option1ExtraUnit = hasOption1Extra && option1ExtraStat !== 'a' ? '%' : '';
  
  const option2Name = statNames[option2Stat].name;
  const option2Unit = option2Stat === 'a' ? '' : '%';
  const option2ExtraName = hasOption2Extra ? statNames[option2ExtraStat].name : '';
  const option2ExtraUnit = hasOption2Extra && option2ExtraStat !== 'a' ? '%' : '';
  
  document.getElementById('comparison-description').innerHTML = `
    <strong>${option1Name} ${option1Value}${option1Unit}${hasOption1Extra ? ' + ' + option1ExtraName + ' ' + option1ExtraValue + option1ExtraUnit : ''}</strong> VS 
    <strong>${option2Name} ${option2Value}${option2Unit}${hasOption2Extra ? ' + ' + option2ExtraName + ' ' + option2ExtraValue + option2ExtraUnit : ''}</strong> 비교
  `;
  
  // 효율 비교 요약
  if (winner === '동일') {
    document.getElementById('efficiency-diff').textContent = '0.00% 차이';
    document.getElementById('efficiency-desc').innerHTML = '두 옵션이 동일한 효율을 가집니다.';
    
    // 상대적 효율 섹션 숨기기
    document.getElementById('relative-efficiency-section').style.display = 'none';
  } else {
    document.getElementById('efficiency-diff').textContent = `${diff.toFixed(3)}% 차이`;
    document.getElementById('efficiency-desc').innerHTML = `
      <strong>${winner}</strong>이(가) <strong>${diff.toFixed(3)}%</strong> 더 효율적입니다.<br>
      ${winner === '옵션 A' ? '옵션 A' : '옵션 B'}의 딜이 ${winner === '옵션 A' ? '옵션 B' : '옵션 A'}보다 <strong>${diffPercent.toFixed(2)}%</strong> 더 높습니다.
    `;
    
    // 상대적 효율 차이 표시
    document.getElementById('relative-efficiency-section').style.display = 'block';
    document.getElementById('relative-efficiency-value').innerHTML = `
      <span class="efficiency-highlight">${relativeEfficiency.toFixed(2)}%</span>
    `;
    
    let winnerText = '';
    let loserText = '';
    
    if (winner === '옵션 A') {
      winnerText = `${option1Name} ${option1Value}${option1Unit}${hasOption1Extra ? ' + ' + option1ExtraName + ' ' + option1ExtraValue + option1ExtraUnit : ''}`;
      loserText = `${option2Name} ${option2Value}${option2Unit}${hasOption2Extra ? ' + ' + option2ExtraName + ' ' + option2ExtraValue + option2ExtraUnit : ''}`;
    } else {
      winnerText = `${option2Name} ${option2Value}${option2Unit}${hasOption2Extra ? ' + ' + option2ExtraName + ' ' + option2ExtraValue + option2ExtraUnit : ''}`;
      loserText = `${option1Name} ${option1Value}${option1Unit}${hasOption1Extra ? ' + ' + option1ExtraName + ' ' + option1ExtraValue + option1ExtraUnit : ''}`;
    }
    
    document.getElementById('relative-efficiency-desc').innerHTML = `
      <strong>${winnerText}</strong>의 딜상승량(<strong>${winnerIncrease.toFixed(3)}%</strong>)이<br>
      <strong>${loserText}</strong>의 딜상승량(<strong>${loserIncrease.toFixed(3)}%</strong>)보다<br>
      <span class="efficiency-highlight">${relativeEfficiency.toFixed(2)}%</span> 더 높습니다.
    `;
    
    document.getElementById('relative-efficiency-note').innerHTML = `
      계산식: (${winnerIncrease.toFixed(3)}% ÷ ${loserIncrease.toFixed(3)}% × 100) - 100 = ${relativeEfficiency.toFixed(2)}%
    `;
  }
  
  // 테이블 생성
  let tableHtml = '';
  
  // 옵션 A 행
  const option1Text = `${option1Name} ${option1Value}${option1Unit}${hasOption1Extra ? '<br>+ ' + option1ExtraName + ' ' + option1ExtraValue + option1ExtraUnit : ''}`;
  tableHtml += `
    <tr class="${winner === '옵션 A' ? 'winner' : ''}">
      <td><strong>${option1Text}</strong></td>
      <td>${option1Damage.toLocaleString(undefined, {maximumFractionDigits: 0})}</td>
      <td class="damage-diff ${option1Increase > 0 ? 'positive' : 'negative'}">${option1Increase > 0 ? '+' : ''}${option1Increase.toFixed(3)}%</td>
      <td>${winner === '옵션 A' ? '+' + diff.toFixed(3) + '%' : '-' + diff.toFixed(3) + '%'}</td>
      <td>${winner === '옵션 A' ? '<span style="color: #4CAF50; font-weight: bold;">✓ 더 좋음</span>' : ''}</td>
    </tr>
  `;
  
  // 옵션 B 행
  const option2Text = `${option2Name} ${option2Value}${option2Unit}${hasOption2Extra ? '<br>+ ' + option2ExtraName + ' ' + option2ExtraValue + option2ExtraUnit : ''}`;
  tableHtml += `
    <tr class="${winner === '옵션 B' ? 'winner' : ''}">
      <td><strong>${option2Text}</strong></td>
      <td>${option2Damage.toLocaleString(undefined, {maximumFractionDigits: 0})}</td>
      <td class="damage-diff ${option2Increase > 0 ? 'positive' : 'negative'}">${option2Increase > 0 ? '+' : ''}${option2Increase.toFixed(3)}%</td>
      <td>${winner === '옵션 B' ? '+' + diff.toFixed(3) + '%' : '-' + diff.toFixed(3) + '%'}</td>
      <td>${winner === '옵션 B' ? '<span style="color: #4CAF50; font-weight: bold;">✓ 더 좋음</span>' : ''}</td>
    </tr>
  `;
  
  // 기본 대미지 행
  tableHtml += `
    <tr style="background: #f5f5f5;">
      <td><strong>기본 대미지</strong></td>
      <td>${baseDamage.toLocaleString(undefined, {maximumFractionDigits: 0})}</td>
      <td>0%</td>
      <td>-</td>
      <td>기준</td>
    </tr>
  `;
  
  document.getElementById('comparison-table-body').innerHTML = tableHtml;
  document.getElementById('comparison-result').style.display = 'block';
  
  // 결과 섹션으로 스크롤
  document.getElementById('comparison-result').scrollIntoView({ behavior: 'smooth' });
}

// 계산 함수
function calculate() {
  const sections = ['base', 'doping'];
  const values = {};
  
  ['a', 'b', 'c', 'd', 'e', 'f', 'g'].forEach(type => {
    values[type] = 0;
    sections.forEach(section => {
      const inputId = `${type}-${section}`;
      const inputValue = Number(document.getElementById(inputId).value) || 0;
      values[type] += inputValue;
    });
  });
  
  displayFinalStats(values);
  
  // 기본 대미지 계산
  const result = calculateDamage(values);
  
  // 딜상승량 분석
  const increases = calculateDamageIncrease(values);
  displayDamageIncrease(increases, result);
  
  const plus5 = result * 1.05;
  const minus5 = result * 0.95;

  const damageOutput = `
    <div class="damage-result">
      <h3><i class="fas fa-bullseye"></i> 대미지 계산 결과</h3>
      
      <div class="damage-item damage-main">
        <div class="damage-label">최종 대미지</div>
        <div class="damage-value">${result.toLocaleString(undefined, {maximumFractionDigits: 0})}</div>
      </div>
      
      <div class="damage-item damage-plus5">
        <div class="damage-label">+5% 대미지 (최대댐)</div>
        <div class="damage-value">${plus5.toLocaleString(undefined, {maximumFractionDigits: 0})}</div>
      </div>
      
      <div class="damage-item damage-minus5">
        <div class="damage-label">-5% 대미지 (최소댐)</div>
        <div class="damage-value">${minus5.toLocaleString(undefined, {maximumFractionDigits: 0})}</div>
      </div>
      
      <div style="margin-top: 20px; font-size: 16px; color: #666;">
        <i class="fas fa-info-circle"></i> 대미지 편차: ±${((plus5 - result)/result*100).toFixed(1)}%
      </div>
    </div>
  `;
  
  document.getElementById("damage-output").innerHTML = damageOutput;
  updateTotalAdded();
}

// 최종 스텟 표시 함수
function displayFinalStats(values) {
  const statsHtml = `
    <div class="stat-item">
      <div class="stat-label-sm">깡공</div>
      <div class="stat-value-sm">${values.a.toLocaleString()}</div>
    </div>
    <div class="stat-item">
      <div class="stat-label-sm">물공%</div>
      <div class="stat-value-sm">${values.b}%</div>
    </div>
    <div class="stat-item">
      <div class="stat-label-sm">스댐%</div>
      <div class="stat-value-sm">${values.c}%</div>
    </div>
    <div class="stat-item">
      <div class="stat-label-sm">보공%</div>
      <div class="stat-value-sm">${values.d}%</div>
    </div>
    <div class="stat-item">
      <div class="stat-label-sm">물댐%</div>
      <div class="stat-value-sm">${values.e}%</div>
    </div>
    <div class="stat-item">
      <div class="stat-label-sm">치피%</div>
      <div class="stat-value-sm">${values.f}%</div>
    </div>
    <div class="stat-item">
      <div class="stat-label-sm">종댐%</div>
      <div class="stat-value-sm">${values.g}%</div>
    </div>
  `;
  document.getElementById("final-stats").innerHTML = statsHtml;
}

// 페이지 로드 시 초기화
window.onload = function() {
  const defaultValues = {
    base: { a: 3000, b: 100, c: 50, d: 100, e: 30, f: 50, g: 40 },
    doping: { a: 0, b: 0, c: 0, d: 0, e: 0, f: 0, g: 0 }
  };
  
  Object.keys(defaultValues).forEach(section => {
    Object.keys(defaultValues[section]).forEach(type => {
      const inputId = `${type}-${section}`;
      const input = document.getElementById(inputId);
      if (input) {
        input.value = defaultValues[section][type];
      }
    });
  });
  
  // 단위 표시 초기화
  updateUnitDisplay('1');
  updateUnitDisplay('1b');
  updateUnitDisplay('2');
  updateUnitDisplay('2b');
  
  updateTotalAdded();
  calculate();
};

// 선택 변경 시 단위 업데이트
document.querySelectorAll('.comparison-select').forEach(select => {
  select.addEventListener('change', function() {
    const inputId = this.id.replace('custom-stat-', '');
    updateUnitDisplay(inputId);
  });
});
</script>

</body>
</html>
